<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>歌曲</title>
	<script src="src/js/jquery-1.11.3.min.js"></script>
</head>
<body>
	<div>歌名：<span class="jvc-name"></span></div>
	<div>频道：<span class="jvc-fm"></span></div>
	<div>封面：<img src="" class="jvc-cover" style="width: 100px;"></div>
	<div><a href="javascript:void(0)" id="play">播放</a><a href="javascript:void(0)" id="pause">暂停</a></div>
	<div>
		<h1>歌曲信息</h1>
		<pre class="jvc-info"></pre>
	</div>
	<div>
		<h1>热门评论</h1>
		<div class="comments"></div>
	</div>

	<div id="template" style="display: none;">
		<div id="template-comment">
			<p>评论人:<span class="jvc-name"></span></p>
			<p>评论人头像：<img class="jvc-avatar"></></p>
			<p>评论时间：<span class="jvc-date"></span></p>
			<p>评论内容：<span class="jvc-content"></span></p>
		</div>
	</div>
	<audio id="audio" class="jvc-audio"></audio>
</body>
</html>
<script type="text/javascript">
	var id = location.search;
	id= id.substring(4,id.length);
	
	// 获取专辑详细信息
	$.ajax({
		url:'http://47.94.100.222/change.php',
		dataType:'json',
		data:{'url':'http://www.app-echo.com/api/sound/info?id='+id+'&comment=1'},
		type:'POST',
		success:function(res){
			console.log(res);
			$('.jvc-name').html(res.info.name);
			$('.jvc-fm').html(res.info.channel.name);
			$('.jvc-cover').attr('src',res.info.pic);
			$('.jvc-info').html(res.info.info);
			$('.jvc-audio').attr('src',res.info.source);
			for(var i=0;i<res.comments.length;i++)
			{
				var id='comment-'+i;
				var comment=res.comments[i]
				$('#template-comment').clone().attr('id',id).appendTo($('.comments')).show();
				$('#'+id).find('.jvc-name').html(comment.user.name);
				$('#'+id).find('.jvc-avatar').attr('src',comment.user.avatar);
				$('#'+id).find('.jvc-date').html(comment.create_time);
				$('#'+id).find('.jvc-content').html(comment.content);
			}
		}
	})
	$('#play').on('click',function(){
		document.getElementById('audio').play();
	})
	$('#pause').on('click',function(){
		document.getElementById('audio').pause();
	})
</script>