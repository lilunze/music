<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>MoJu-Music</title>
	<script src="src/js/jquery-1.11.3.min.js"></script>
</head>
<body>
	<h1>专辑分类</h1>
	<a href="javascript:tab('new')">新上专辑</a>
	<a href="javascript:tab('hot')">热门</a>

	<div>
		<h1>专辑列表</h1>
		<div class="albums"></div>
	</div>

	<!-- 模版 -->
	<div id="template" style="display: none;">
		<div id="template-album">
			<p><img src="" class="jvc-cover" style="width: 100px"></p>
			<p><span class="jvc-name"></span></p>
			<p><span class="jvc-singer"></span></p>
			<p>评分：<span class="jvc-star"></span></p>
		</div>
		<div id="template-classify">
			<h1>流派</h1>
			<div>
				<a href="javascript:set_type('A0')">全部</a>
				<a href="javascript:set_type('A1')">摇滚</a>
				<a href="javascript:set_type('A2')">流行</a>
				<a href="javascript:set_type('A3')">电子</a>
				<a href="javascript:set_type('A4')">古典</a>
				<a href="javascript:set_type('A5')">爵士</a>
				<a href="javascript:set_type('A6')">民谣</a>
				<a href="javascript:set_type('A7')">原声</a>
				<a href="javascript:set_type('A8')">说唱</a>
				<a href="javascript:set_type('A9')">世界音乐</a>
				<a href="javascript:set_type('A10')">轻音乐</a>
				<a href="javascript:set_type('A11')">蓝调</a>
				<a href="javascript:set_type('A12')">节奏蓝调</a>
			</div>
			<h1>年代</h1>
			<div>
				<a href="javascript:set_age('A0')">全部</a>
				<a href="javascript:set_age('A1')">70年代</a>
				<a href="javascript:set_age('A2')">80年代</a>
				<a href="javascript:set_age('A3')">90年代</a>
				<a href="javascript:set_age('A4')">00年代</a>
				<a href="javascript:set_age('A5')">10年代</a>
			</div>
		</div>
	</div>
</body>
</html>
<script>

	var type='A0',age='A0';
	// 切换专辑分类
	function tab(classify)
	{
		if(classify=='hot')
		{
			show_hot();
		}
		else
		{
			show_news();
		}
	}

	// 切换专辑类型
	function set_type(type)
	{
		type=type;
		show_news();
	}

	// 切换专辑年代
	function set_age(age)
	{
		age=age;
		show_news();
	}
	function show_hot()
	{
		$.ajax({
			url:'http://47.94.100.222/change.php',
			dataType:'json',
			data:{'url':'http://www.app-echo.com/api/album/list-for-tab?type=hot&limit=20'},
			type:'POST',
			success:function(res){
				var lists=res.list;
				$('.albums').empty();
				for(var i=0;i<lists.length;i++)
				{
					var id='album-'+i;
					$('#template-album').clone().attr('id',id).appendTo($('.albums')).show();
					$('#'+id).find('.jvc-cover').attr('src',lists[i].cover_url);
					$('#'+id).find('.jvc-name').html(lists[i].name);
					$('#'+id).find('.jvc-singer').html(lists[i].user.name);
					$('#'+id).find('.jvc-star').html(lists[i].score.average_score);
				}
			}
		})
	}

	function show_news()
	{
		$('.albums').empty();
		$('#template-classify').clone().appendTo($('.albums'));
		$.ajax({
			url:'http://47.94.100.222/change.php',
			dataType:'json',
			data:{'url':'http://www.app-echo.com/api/album/list?limit=20&page=2&condition=1%3'+type+'%2C2%3'+age},
			type:'POST',
			success:function(res){
				var lists=res.list;
				for(var i=0;i<lists.length;i++)
				{
					var id='album-'+i;
					$('#template-album').clone().attr('id',id).appendTo($('.albums')).show();
					$('#'+id).find('.jvc-cover').attr('src',lists[i].cover_url);
					$('#'+id).find('.jvc-name').html(lists[i].name);
					$('#'+id).find('.jvc-singer').html(lists[i].user.name);
					$('#'+id).find('.jvc-star').html(lists[i].score.average_score);
				}
			}
		})
	}
	
</script>